# 测试计划与文档 (Test Plan & Documentation)

## 1. 测试概览 (Overview)
本测试计划旨在验证 "Map of Science" (科学地图) 核心功能的正确性，重点解决已知的视图定位 Bug，并确保所有界面元素已正确中文化。

## 2. 测试环境 (Environment)
- **操作系统**: macOS / Windows / Linux (Docker Container)
- **浏览器**: Chrome (最新版), Safari, Firefox
- **分辨率**: 1920x1080 (桌面端)
- **URL**: `http://localhost:3000/map` (本地开发) 或 `http://localhost:3001/map` (Docker)

## 3. Bug 修复验证 (Bug Fix Verification)

### Bug 1: 点击 "化学" (Chemistry) 居中错误
**描述**: 用户报告点击 "Chemistry" 时，视图中心会偏移到 "Biology" 或其他节点。
**预期行为**: 点击任意节点，视图应平滑移动，使**该节点**准确位于屏幕中央。
**测试步骤**:
1. 打开网页，等待动画稳定。
2. 找到并点击 "化学" 节点。
3. **验证**: 视图移动停止后，屏幕正中央是否为 "化学" 节点？
4. **验证**: 侧边栏是否显示 "化学" 的详情？

### Bug 2: 点击 "物理" (Physics) 居中错误
**描述**: 用户报告点击 "Physics" 时，视图中心偏移。
**预期行为**: 点击 "物理学"，视图准确聚焦于 "物理学"。
**测试步骤**:
1. 刷新页面。
2. 点击 "物理学" 节点。
3. **验证**: 视图是否聚焦于 "物理学"？
4. **验证**: 侧边栏是否显示 "物理学" 的详情？

### Bug 3: 屏幕中心模糊
**描述**: 之前的居中逻辑可能导致节点并未严格居中。
**修复**: 引入了 `nodePositions` 引用来保持节点在重新渲染时的坐标稳定性，防止布局重置导致的坐标漂移。
**测试步骤**:
1. 连续快速点击多个不同节点（如：数学 -> 物理 -> 化学）。
2. **验证**: 每次点击后，视图都能准确跟随并居中到被点击的节点，且节点位置没有发生突兀的跳变或重置。

## 4. 中文化验证 (Localization Verification)

### 界面文本
- [ ] **标题**: 左上角显示 "科学地图"。
- [ ] **说明**: 显示 "点击节点展开/折叠"。
- [ ] **侧边栏**: 
    - [ ] 标题显示中文节点名（如 "微积分"）。
    - [ ] 字段标题显示：定义、理论、公式、关键论文、历史、应用。
    - [ ] 空状态提示显示："从图谱中选择一个节点以查看详情"。

### 数据内容
- [ ] **根节点**: 显示 "科学"。
- [ ] **一级分支**: 显示 "数学"、"物理学"、"化学"、"生物学"。
- [ ] **二级分支**: 检查如 "微积分"、"量子力学" 等是否显示中文。
- [ ] **详情**: 点击 "科学" 和 "微积分"，检查侧边栏中的描述文字是否为中文。

## 5. 功能回归测试 (Regression Testing)

### 交互性
- [ ] **展开/折叠**: 点击带圆点的父节点，子节点应正常展开或收起。
- [ ] **侧边栏开关**: 点击节点打开侧边栏，点击侧边栏右上角 "×" 号关闭。
- [ ] **缩放/拖拽**: 鼠标滚轮缩放正常，拖拽背景平移视图正常。

### 视觉效果
- [ ] **星空背景**: 背景是否为动态星空？
- [ ] **节点样式**: 是否为圆角矩形，文字居中？

## 6. 自动化测试建议 (Automated Testing Strategy)
由于涉及 Canvas 和 WebGL (react-force-graph)，传统的 DOM 测试 (如 Jest + React Testing Library) 难以验证节点位置和点击效果。建议采用端到端 (E2E) 测试工具：
- **工具**: Cypress 或 Playwright
- **策略**: 
    - 使用图像对比 (Visual Regression Testing) 验证渲染结果。
    - 模拟坐标点击 (Mouse Click at coordinates) 并验证 Canvas 状态或侧边栏 DOM 变化。

---

**测试执行记录**:
- [ ] Bug 1 (化学居中) - Pass/Fail
- [ ] Bug 2 (物理居中) - Pass/Fail
- [ ] 中文化检查 - Pass/Fail
